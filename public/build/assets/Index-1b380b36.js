import{o,c as n,b as e,d as O,e as y,i as P,a as p,w as R,u as x,F as U,Z as A,t as c,j as K,f as h,g as b,k as W,r as T,h as f,v as z,l as g,m as Z,O as B}from"./app-2cac3384.js";import{_ as G}from"./AdminLayout-01e4b994.js";import{P as H}from"./Pagination-c0764a58.js";import J from"./CreateCurrency-4a4925e0.js";import{_ as I}from"./Spinner-dd5ccd9b.js";import{D as Q}from"./DeleteIcon-cf10fd1b.js";import{E as X}from"./EditIcon-a8ad6404.js";import{u as Y}from"./useAPI-d04b5e55.js";import{u as ee}from"./notification-c7ee7316.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as se}from"./TextInput-ce71653f.js";import"./ResponsiveNavLink-a7d45309.js";import"./FlashMessage-9f6c2265.js";import"./CustomSidebar-a20985df.js";import"./SidebarElement-5e7556c1.js";import"./SelectInput-08f1fdd6.js";const oe={name:"SaveIcon"},ae={fill:"none",stroke:"currentColor","stroke-width":"1.5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true"},re=e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1),ne=[re];function le(_,l,i,u,t,k){return o(),n("svg",ae,ne)}const ie=te(oe,[["render",le]]),ce=e("title",null,`
            Currencies
        `,-1),de={class:"ml-4 md:ml-8 mr-4 md:mr-8"},ue={class:"mt-16 mb-8 text-xl flex items-center justify-between"},pe=e("div",null," Currencies ",-1),me={class:"text-sm"},fe={class:"flex items-center"},_e={key:0,class:"mb-8"},he={class:"flex items-end gap-3"},be={class:"relative overflow-x-auto shadow-md sm:rounded-lg"},ve={class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},ye=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{class:"px-6 py-3",scope:"col"}," Currency Code "),e("th",{class:"px-6 py-3",scope:"col"}," Currency name "),e("th",{class:"px-6 py-3",scope:"col"}," Current WB Rate (to USD) "),e("th",{class:"px-6 py-3",scope:"col"}," Special Rate (to USD) "),e("th",{class:"px-6 py-3",scope:"col"}," Rate source (WB/Special) "),e("th",{class:"px-6 py-3",scope:"col"}," Actions ")])],-1),xe={class:"px-6 py-4"},ge={class:"px-6 py-4"},ke={key:1},we={class:"px-6 py-4"},Ce={key:1},Se={class:"px-6 py-4"},$e={key:1},Ve={class:"px-6 py-4 uppercase"},Ee=e("option",{value:"world_bank"},"World Bank",-1),qe=e("option",{value:"special"},"Special Rate",-1),Re=[Ee,qe],Ue={key:1},Be={class:"px-6 py-4 flex gap-4 items-center"},Ie={name:"Currencies/Index"},Je=Object.assign(Ie,{props:{currencies:{required:!0,type:Object},info:{type:Object,default:""}},setup(_){const l=_,i=Y(),u=ee(),t=O({}),k=r=>{t.value={...r}},D=async()=>{i.startRequest();try{if((await axios.put("/admin/currencies/update/"+t.value.id,t.value)).data){u.notify("Currency updated","success");let a=l.currencies.data.findIndex(s=>s.id===t.value.id);l.currencies.data.splice(a,1,t.value),F()}}catch(r){u.notify("Error","error"),i.handleErrors(r)}finally{i.requestCompleted()}},F=()=>{i.errors.value={},t.value={}},j=()=>{l.currencies.total++},w=y(null),L=async r=>{w.value=r.id,i.startRequest();try{const a=await axios.delete("/admin/currencies/delete/"+r.id);(a.data.id||a.data.status==="success")&&(u.notify("Currency deleted","success"),r.id="deleted",l.currencies.total--)}catch(a){u.notify("Error, this base currency can not be deleted.","error"),i.handleErrors(a)}finally{i.requestCompleted()}},v=y(!1),M=async()=>{i.startRequest(),v.value=!0;try{const r=await axios.put("/admin/currencies/update-rates");r.data.status==="success"&&(u.notify("Currency rates updated","success"),l.currencies.data=r.data.currencies,l.info.fetched_at=r.data.fetched_at)}catch(r){u.notify("Error, could not fetch world bank rates.","error"),i.handleErrors(r)}finally{v.value=!1,i.requestCompleted()}},m=y(""),C=()=>{B.visit(`?q=${m.value}`)},N=()=>{B.visit("?q=")};return P(()=>{m.value=new URLSearchParams(window.location.search).get("q")}),(r,a)=>(o(),n(U,null,[p(x(A),{title:"Currencies"},{default:R(()=>[ce]),_:1}),p(G,null,{default:R(()=>[e("div",de,[e("div",ue,[pe,e("div",me," Page: "+c(l.currencies.current_page)+" | total: "+c(l.currencies.total)+" | from: "+c(l.currencies.from)+", to: "+c(l.currencies.to),1)]),p(J,{onCurrencyAdded:j}),e("div",fe,[e("button",{onClick:M,type:"button",class:"mb-8 flex items-center text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"},[K(" Fetch world bank rates "),x(i).isLoading.value&&v.value?(o(),h(I,{key:0,class:"ml-3 button-spinner-center action-btn"})):b("",!0)]),_.info.fetched_at?(o(),n("div",_e," Last fetched: "+c(_.info.fetched_at),1)):b("",!0)]),e("div",he,[p(se,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=s=>m.value=s),class:"mb-8",label:"Search by currency code",placeholder:"USD",title:"searchValue",onKeyup:W(C,["enter"])},null,8,["modelValue","onKeyup"]),e("button",{onClick:C,type:"button",class:"mb-8 flex items-center text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"}," Search "),m.value?(o(),n("button",{key:0,onClick:N,type:"button",class:"mb-8 flex items-center text-blue-700 bg-white border border-blue-700 hover:bg-gray-100 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800"}," Clear ")):b("",!0)]),e("div",be,[e("table",ve,[ye,e("tbody",null,[(o(!0),n(U,null,T(l.currencies.data,s=>{var S,$,V,E,q;return f((o(),n("tr",{key:s.id,class:"bg-white border-b dark:bg-gray-900 dark:border-gray-700"},[e("td",xe,[e("span",null,c(s.code),1)]),e("td",ge,[((S=t.value)==null?void 0:S.id)===s.id?f((o(),n("input",{key:0,type:"text",class:"w-32 text-black","onUpdate:modelValue":a[1]||(a[1]=d=>t.value.name=d)},null,512)),[[g,t.value.name]]):(o(),n("span",ke,c(s.name),1))]),e("td",we,[(($=t.value)==null?void 0:$.id)===s.id?f((o(),n("input",{key:0,type:"number",class:"w-20 text-black","onUpdate:modelValue":a[2]||(a[2]=d=>t.value.rate=d)},null,512)),[[g,t.value.rate]]):(o(),n("span",Ce,c(parseFloat(s.rate).toFixed(2)),1))]),e("td",Se,[((V=t.value)==null?void 0:V.id)===s.id?f((o(),n("input",{key:0,type:"number",class:"w-20 text-black","onUpdate:modelValue":a[3]||(a[3]=d=>t.value.special_rate=d)},null,512)),[[g,t.value.special_rate]]):(o(),n("span",$e,c(parseFloat(s.special_rate).toFixed(2)),1))]),e("td",Ve,[((E=t.value)==null?void 0:E.id)===s.id?f((o(),n("select",{key:0,name:"rate_source",id:"rate_source","onUpdate:modelValue":a[4]||(a[4]=d=>t.value.rate_source=d)},Re,512)),[[Z,t.value.rate_source]]):(o(),n("span",Ue,c(s.rate_source.replace("_"," ")),1))]),e("td",Be,[p(Q,{onClick:d=>L(s),class:"w-8 hover:cursor-pointer hover:bg-red-600 hover:text-white rounded-md p-1"},null,8,["onClick"]),((q=t.value)==null?void 0:q.id)===s.id?(o(),h(ie,{key:0,onClick:D,class:"w-8 hover:cursor-pointer hover:bg-green-600 hover:text-white rounded-md p-1"})):(o(),h(X,{key:1,onClick:d=>k(s),class:"w-8 hover:cursor-pointer hover:bg-blue-600 hover:text-white rounded-md p-1"},null,8,["onClick"])),x(i).isLoading.value&&w.value===s.id?(o(),h(I,{key:2,class:"button-spinner-center action-btn"})):b("",!0)])])),[[z,s.id!=="deleted"]])}),128))])])]),p(H,{links:l.currencies.links},null,8,["links"])])]),_:1})],64))}});export{Je as default};
