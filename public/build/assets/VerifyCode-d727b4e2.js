import{u as g}from"./notification-c7ee7316.js";import{u as V}from"./useAPI-d04b5e55.js";import C from"./ResendEmailCode-c10352ad.js";import{e as c,c as b,b as u,a as r,u as a,O as f,o as h}from"./app-2cac3384.js";import{N as p}from"./NewActionButton-14875054.js";import{_ as k}from"./NewTextInput-857cb469.js";import"./Spinner-dd5ccd9b.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./FiftyText-1e25ff4f.js";/* empty css                                                     */const w={class:"verify-code-form-wrapper"},x={class:"code-input"},B={class:"action-buttons"},N={name:"VerifyCode"},R=Object.assign(N,{props:{user:{default:null,type:Object}},emits:["verified"],setup(m,{emit:v}){const n=m,o=V(),_=c(!!n.user.email_verified_at||!!n.user.phone_verified_at),t=c(""),s=g(),y=async()=>{o.startRequest();try{(await axios.post("/api/verify-user",{code:t.value})).data.status==="valid"?(v("verified"),_.value=!0,s.notify("Verified","success")):(o.errors.value.verificationCode=["Invalid code"],s.notify("Invalid code","error"))}catch(i){let e="Invalid code";i.response.status===419&&(f.get("/user-info",{message:"session expired"},{preserveState:!1}),e="Session expired, please reload the page.",setTimeout(()=>{window.location="/user-info"},1e3)),s.notify(e,"error"),o.handleErrors(i)}finally{o.requestCompleted()}};return(i,e)=>{var d;return h(),b("div",w,[u("div",x,[r(k,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=l=>t.value=l),errors:(d=a(o).errors.value)==null?void 0:d.code,label:"Verification code",placeholder:"6-digit code",required:"",title:"verificationCode"},null,8,["modelValue","errors"]),r(C)]),u("div",B,[r(p,{title:"Back",reversed:!0,onClick:e[1]||(e[1]=l=>a(f).get("/user-info"))}),r(p,{title:"Verify",isLoading:a(o).isLoading.value,onClick:y},null,8,["isLoading"])])])}}});export{R as default};
