import{K as O,e as c,d as L,i as T,z as _,c as U,a as v,u as b,w as m,D as Z,b as N,O as P,o as n,j as H,f as I,t as y,g as V}from"./app-2cac3384.js";import{u as Y}from"./useAPI-d04b5e55.js";import{u as W}from"./notification-c7ee7316.js";import{c as F}from"./currencies_countries-fbccd8be.js";import{_ as g}from"./Spinner-dd5ccd9b.js";import{N as C}from"./NewActionButton-14875054.js";import{_ as h}from"./NewTextInput-857cb469.js";import{_ as p}from"./NewSelectInput-dc65b2d8.js";import{_ as x}from"./FiftyText-1e25ff4f.js";import"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                     */const J=[{label:"EUR",value:"EUR"},{label:"AED",value:"AED"},{label:"AFN",value:"AFN"},{label:"XCD",value:"XCD"},{label:"XCD",value:"XCD"},{label:"ALL",value:"ALL"},{label:"AMD",value:"AMD"},{label:"AOA",value:"AOA"},{label:"ARS",value:"ARS"},{label:"USD",value:"USD"},{label:"EUR",value:"EUR"},{label:"AUD",value:"AUD"},{label:"AWG",value:"AWG"},{label:"EUR",value:"EUR"},{label:"AZN",value:"AZN"},{label:"BAM",value:"BAM"},{label:"BBD",value:"BBD"},{label:"BDT",value:"BDT"},{label:"EUR",value:"EUR"},{label:"XOF",value:"XOF"},{label:"BGN",value:"BGN"},{label:"BHD",value:"BHD"},{label:"BIF",value:"BIF"},{label:"XOF",value:"XOF"},{label:"EUR",value:"EUR"},{label:"BMD",value:"BMD"},{label:"BND",value:"BND"},{label:"BOB",value:"BOB"},{label:"USD",value:"USD"},{label:"BRL",value:"BRL"},{label:"BSD",value:"BSD"},{label:"BTN",value:"BTN"},{label:"NOK",value:"NOK"},{label:"BWP",value:"BWP"},{label:"BYR",value:"BYR"},{label:"BZD",value:"BZD"},{label:"CAD",value:"CAD"},{label:"AUD",value:"AUD"},{label:"CDF",value:"CDF"},{label:"XAF",value:"XAF"},{label:"XAF",value:"XAF"},{label:"CHF",value:"CHF"},{label:"XOF",value:"XOF"},{label:"NZD",value:"NZD"},{label:"CLP",value:"CLP"},{label:"XAF",value:"XAF"},{label:"CNY",value:"CNY"},{label:"COP",value:"COP"},{label:"CRC",value:"CRC"},{label:"CUP",value:"CUP"},{label:"CVE",value:"CVE"},{label:"ANG",value:"ANG"},{label:"AUD",value:"AUD"},{label:"EUR",value:"EUR"},{label:"CZK",value:"CZK"},{label:"EUR",value:"EUR"},{label:"DJF",value:"DJF"},{label:"DKK",value:"DKK"},{label:"XCD",value:"XCD"},{label:"DOP",value:"DOP"},{label:"DZD",value:"DZD"},{label:"USD",value:"USD"},{label:"EUR",value:"EUR"},{label:"EGP",value:"EGP"},{label:"MAD",value:"MAD"},{label:"ERN",value:"ERN"},{label:"EUR",value:"EUR"},{label:"ETB",value:"ETB"},{label:"EUR",value:"EUR"},{label:"FJD",value:"FJD"},{label:"FKP",value:"FKP"},{label:"USD",value:"USD"},{label:"DKK",value:"DKK"},{label:"EUR",value:"EUR"},{label:"XAF",value:"XAF"},{label:"GBP",value:"GBP"},{label:"XCD",value:"XCD"},{label:"GEL",value:"GEL"},{label:"EUR",value:"EUR"},{label:"GBP",value:"GBP"},{label:"GHS",value:"GHS"},{label:"GIP",value:"GIP"},{label:"DKK",value:"DKK"},{label:"GMD",value:"GMD"},{label:"GNF",value:"GNF"},{label:"EUR",value:"EUR"},{label:"XAF",value:"XAF"},{label:"EUR",value:"EUR"},{label:"GBP",value:"GBP"},{label:"GTQ",value:"GTQ"},{label:"USD",value:"USD"},{label:"XOF",value:"XOF"},{label:"GYD",value:"GYD"},{label:"HKD",value:"HKD"},{label:"AUD",value:"AUD"},{label:"HNL",value:"HNL"},{label:"HRK",value:"HRK"},{label:"HTG",value:"HTG"},{label:"HUF",value:"HUF"},{label:"IDR",value:"IDR"},{label:"EUR",value:"EUR"},{label:"ILS",value:"ILS"},{label:"GBP",value:"GBP"},{label:"INR",value:"INR"},{label:"USD",value:"USD"},{label:"IQD",value:"IQD"},{label:"IRR",value:"IRR"},{label:"ISK",value:"ISK"},{label:"EUR",value:"EUR"},{label:"GBP",value:"GBP"},{label:"JMD",value:"JMD"},{label:"JOD",value:"JOD"},{label:"JPY",value:"JPY"},{label:"KES",value:"KES"},{label:"KGS",value:"KGS"},{label:"KHR",value:"KHR"},{label:"AUD",value:"AUD"},{label:"KMF",value:"KMF"},{label:"XCD",value:"XCD"},{label:"KPW",value:"KPW"},{label:"KRW",value:"KRW"},{label:"KWD",value:"KWD"},{label:"KYD",value:"KYD"},{label:"KZT",value:"KZT"},{label:"LAK",value:"LAK"},{label:"LBP",value:"LBP"},{label:"XCD",value:"XCD"},{label:"CHF",value:"CHF"},{label:"LKR",value:"LKR"},{label:"LRD",value:"LRD"},{label:"LSL",value:"LSL"},{label:"EUR",value:"EUR"},{label:"EUR",value:"EUR"},{label:"EUR",value:"EUR"},{label:"LYD",value:"LYD"},{label:"MAD",value:"MAD"},{label:"EUR",value:"EUR"},{label:"MDL",value:"MDL"},{label:"EUR",value:"EUR"},{label:"EUR",value:"EUR"},{label:"MGA",value:"MGA"},{label:"USD",value:"USD"},{label:"MKD",value:"MKD"},{label:"XOF",value:"XOF"},{label:"MMK",value:"MMK"},{label:"MNT",value:"MNT"},{label:"MOP",value:"MOP"},{label:"USD",value:"USD"},{label:"EUR",value:"EUR"},{label:"MRO",value:"MRO"},{label:"XCD",value:"XCD"},{label:"EUR",value:"EUR"},{label:"MUR",value:"MUR"},{label:"MVR",value:"MVR"},{label:"MWK",value:"MWK"},{label:"MXN",value:"MXN"},{label:"MYR",value:"MYR"},{label:"MZN",value:"MZN"},{label:"NAD",value:"NAD"},{label:"XPF",value:"XPF"},{label:"XOF",value:"XOF"},{label:"AUD",value:"AUD"},{label:"NGN",value:"NGN"},{label:"NIO",value:"NIO"},{label:"EUR",value:"EUR"},{label:"NOK",value:"NOK"},{label:"NPR",value:"NPR"},{label:"AUD",value:"AUD"},{label:"NZD",value:"NZD"},{label:"NZD",value:"NZD"},{label:"OMR",value:"OMR"},{label:"PAB",value:"PAB"},{label:"PEN",value:"PEN"},{label:"XPF",value:"XPF"},{label:"PGK",value:"PGK"},{label:"PHP",value:"PHP"},{label:"PKR",value:"PKR"},{label:"PLN",value:"PLN"},{label:"EUR",value:"EUR"},{label:"NZD",value:"NZD"},{label:"USD",value:"USD"},{label:"ILS",value:"ILS"},{label:"EUR",value:"EUR"},{label:"USD",value:"USD"},{label:"PYG",value:"PYG"},{label:"QAR",value:"QAR"},{label:"EUR",value:"EUR"},{label:"RON",value:"RON"},{label:"RSD",value:"RSD"},{label:"RUB",value:"RUB"},{label:"RWF",value:"RWF"},{label:"SAR",value:"SAR"},{label:"SBD",value:"SBD"},{label:"SCR",value:"SCR"},{label:"SDG",value:"SDG"},{label:"SEK",value:"SEK"},{label:"SGD",value:"SGD"},{label:"SHP",value:"SHP"},{label:"EUR",value:"EUR"},{label:"NOK",value:"NOK"},{label:"EUR",value:"EUR"},{label:"SLL",value:"SLL"},{label:"EUR",value:"EUR"},{label:"XOF",value:"XOF"},{label:"SOS",value:"SOS"},{label:"SRD",value:"SRD"},{label:"SSP",value:"SSP"},{label:"STD",value:"STD"},{label:"USD",value:"USD"},{label:"ANG",value:"ANG"},{label:"SYP",value:"SYP"},{label:"SZL",value:"SZL"},{label:"USD",value:"USD"},{label:"XAF",value:"XAF"},{label:"EUR",value:"EUR"},{label:"XOF",value:"XOF"},{label:"THB",value:"THB"},{label:"TJS",value:"TJS"},{label:"NZD",value:"NZD"},{label:"USD",value:"USD"},{label:"TMT",value:"TMT"},{label:"TND",value:"TND"},{label:"TOP",value:"TOP"},{label:"TRY",value:"TRY"},{label:"TTD",value:"TTD"},{label:"AUD",value:"AUD"},{label:"TWD",value:"TWD"},{label:"TZS",value:"TZS"},{label:"UAH",value:"UAH"},{label:"UGX",value:"UGX"},{label:"USD",value:"USD"},{label:"USD",value:"USD"},{label:"UYU",value:"UYU"},{label:"UZS",value:"UZS"},{label:"EUR",value:"EUR"},{label:"XCD",value:"XCD"},{label:"VEF",value:"VEF"},{label:"USD",value:"USD"},{label:"USD",value:"USD"},{label:"VND",value:"VND"},{label:"VUV",value:"VUV"},{label:"XPF",value:"XPF"},{label:"WST",value:"WST"},{label:"EUR",value:"EUR"},{label:"YER",value:"YER"},{label:"EUR",value:"EUR"},{label:"ZAR",value:"ZAR"},{label:"ZMW",value:"ZMW"},{label:"ZWL",value:"ZWL"}],w={class:"transaction-info-form-wrapper"},k={key:0,class:"receiver-gets-wrapper m-auto"},q={class:"receiver-gets"},Q={key:1,class:"amount"},$={class:"action-buttons"},j={name:"PaymentInformationForm"},Dl=Object.assign(j,{props:{user:{required:!0,default:null,type:Object},receivingCountries:{required:!0,default:[],type:Array}},emits:["stepChanged"],setup(R,{emit:z}){const o=R,u=Y(),s=W(),K=O().props.geoDetails,D=c(!1),i=c(0),t=c(!1),l=L({amount:"",currency:F[K.country_code],country:""}),B=async()=>{u.startRequest();try{const a=await axios.post("/api/collect-payment-info",l);a.data.status==="success"?f("/receiver-info?payment-reference-identification="+a.data.paymentIntent.id+"&country="+l.country):s.notify("Unexpected error happen","error")}catch(a){u.handleErrors(a),s.notify("Invalid data submitted","error")}finally{u.requestCompleted()}},S=async()=>{D.value=!0;const a=o.receivingCountries.find(e=>e.code_iso_2===l.country||e.code===l.country);try{const e=await axios.post("/api/convert-currency",{baseCurrency:l.currency,requiredCurrency:a.currency.code});i.value=e==null?void 0:e.data[a.currency.code].value}catch{s.notify("Exchange rate is not available at the moment..","error")}finally{D.value=!1}},f=a=>{P.get(a)},X=()=>{l.amount=parseFloat((o.user.handled_transaction.payment_intent.amount_in_receiver_currency/100).toFixed(2)),l.country=o.user.handled_transaction.user.country};T(()=>{t.value=!!o.user.transaction_id,t.value&&X()});const G=()=>{P.visit("/")},M=_(()=>parseFloat((i.value*l.amount).toFixed(2)));return(a,e)=>{var E,d,A;return n(),U("div",w,[v(h,{modelValue:l.amount,"onUpdate:modelValue":e[0]||(e[0]=r=>l.amount=r),disabled:t.value,errors:(E=b(u).errors.value)==null?void 0:E.amount,label:"Amount",placeholder:"99",required:"",title:"amount",class:"fifty-form-input",type:"number"},null,8,["modelValue","disabled","errors"]),v(p,{modelValue:l.currency,"onUpdate:modelValue":[e[1]||(e[1]=r=>l.currency=r),S],disabled:t.value,errors:(d=b(u).errors.value)==null?void 0:d.currency,options:b(J),label:"Currency",placeholder:"Currency of your payment card",required:"",title:"country",class:"fifty-form-input",type:"text"},null,8,["modelValue","disabled","errors","options"]),v(p,{modelValue:l.country,"onUpdate:modelValue":[e[2]||(e[2]=r=>l.country=r),S],disabled:t.value,errors:(A=b(u).errors.value)==null?void 0:A.country,options:R.receivingCountries,label:"Receiver Country","label-accessor":"label",placeholder:"Country",required:"",title:"country",class:"fifty-form-input country",type:"text","value-accessor":"code_iso_2"},null,8,["modelValue","disabled","errors","options"]),v(Z,{mode:"out-in",name:"fade"},{default:m(()=>[i.value&&l.amount?(n(),U("div",k,[N("div",q,[v(x,{class:"title"},{default:m(()=>[H(" The receiver will get approximately ")]),_:1}),D.value?(n(),I(g,{key:0})):(n(),U("div",Q,y(b(M))+" "+y(b(F)[l.country]),1))])])):V("",!0)]),_:1}),N("div",$,[v(C,{reversed:!0,type:"button",title:"Cancel",onClick:G}),v(C,{isLoading:b(u).isLoading.value,type:"button",title:"Continue",onClick:B},null,8,["isLoading"])])])}}});export{Dl as default};
